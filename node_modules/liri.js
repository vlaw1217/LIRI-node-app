//let moment = require("moment");
const Spotify = require("node-spotify-api");
let keys = require("./keys.js");
//console.log(keys)
let spotify = new Spotify(keys.spotify);
//console.log(spotify)

let liriInput = process.argv[2];
//console.log(liriInput)
let input = process.argv.slice(3).join(" ");
//console.log(input)

// Case to determine which type of search
switch (liriInput) {
    case "song-this":
        songThis(input);
        break;
    case "movie-this":
        movieThis(input);
        break;
    case "concert-this":
        concertThis(input);
        break;
    case "free-type":
        freeType();
        break;
    default:
        console.log(`----------------------------------
        1. song-this
        2. movie-this
        3. concert-this
        4. free-type
                        ------------------`);
        //End type search          

        //----------------Spotify----------------//

        //Start for song Search
        function songThis() {
            spotify.search({ type: "track", limit: 1, query: input })
                .then(function (response) {
                    let output = response.tracks.items[0];
                    let dataOutput =
                        `Artists(s): ${output.artists[0].name}
            Album Name: ${output.album.name}
            Album Type: ${output.album.album_type}
            Song Name: ${output.name}
            Total Track: ${output.track_number}
            Release Date: ${output.album.release_date}`
                    console.log("===================================================================")
                    console.log(dataOutput)

                })
                .catch(function (err) {
                    console.log("Error", err.message);
                });
        }
        // End for song Search

        //STart for movie search
        function movieThis() {
            const axios = require("axios");
            let keys = require("./keys");

            //console.log(keys.omdbApi.OMDbAPIkey);
            omdbKey = keys.omdbApi.OMDbAPIkey;
            
            let movieName = process.argv.slice(3).join(" ");

            //axios.get("http://www.omdbapi.com/?apikey=322bb18e&t&t=avengers&r&s")
            axios.get("http://www.omdbapi.com/?apikey="+omdbKey+"&t=" + movieName + "&r&s")
            
                //console.log(response);
                
                .then(function (response) {
                    let outputOmdb = response.data
                    //console.log(outputOmdb)
                    
                    let dataOutputOmdb =
                        `Movie Name: ${outputOmdb.Title}
            Genre: ${outputOmdb.Genre}
            Released: ${outputOmdb.Released}
            Actors: ${outputOmdb.Actors}
            Plot: ${outputOmdb.Plot}`
                    console.log("===================================================================")
                    console.log(dataOutputOmdb);
                })
                .catch(function (err) {
                console.log("Error", err.message)
            });

        }


    //end for movie search



}
//------------npm-----------------//
/*function movieThis(inputArg) {
    const axios = require("axios");
    //let keys = require("./keys");
    let omdb = new axios(keys.OMDbAPIkey);
    console.log(omdb)
    let input = movieThis + process.argv[3];
    axios.get(input.omdb)
        .then(function (response) {

            let outputOmdb = response
            let dataOutputOmdb =
            `Title Name: ${outputOmdb.Title}
            Genre: ${outputOmdb.Genre}
            Released: ${outputOmdb.Released}
            Actors: ${outputOmdb.Actors}
            Plot: ${outputOmdb.Plot}`
            console.log("===================================================================")
            console.log(dataOutputOmdb)

        });*/




